<!DOCTYPE html>
<html lang="en">
	<head>
		<title>Simulación Tsunami</title>
		<meta name="generator" content="Hugo" />
		<meta charset="utf-8">
		<meta name="viewport" content="width=device-width, user-scalable=no, minimum-scale=1.0, maximum-scale=1.0">
		<meta name="author" content="https://github.com/josemagr95/ José Gómez ">
		<meta name="description" content="Data asset: Talcahuano, Chile." />
		<meta name="keywords" content="" />
		<meta name="robots" content="noodp" />
		<meta name="theme-color" content="#252627" />	
		
		<link rel="apple-touch-icon" sizes="180x180" href="./apple-touch-icon.png">
		<link rel="icon" type="image/png" sizes="32x32" href="./favicon-32x32.png">
		<link rel="icon" type="image/png" sizes="16x16" href="./favicon-16x16.png">
		<link rel="mask-icon" href="./safari-pinned-tab.svg" color="#252627">
		<link rel="shortcut icon" href="./favicon.ico">
		<meta name="msapplication-TileColor" content="#252627">
		<meta name="theme-color" content="#252627">
	
		<link type="text/css" rel="stylesheet" href="style.css">
		<link rel="canonical" href="./" />
		<link href="https://cdnjs.cloudflare.com/ajax/libs/flag-icon-css/3.2.1/css/flag-icon.min.css" rel="stylesheet"
		type="text/css">
		<link rel="stylesheet" href="./main.154a87e0ff720e102948892a8eb80881aa81a4faf37376f3093be219f6296c3d.css">


		<title>        
            Simulación Tsunami        
		</title>
		
		<meta itemprop="name" content="Simulación Tsunami">
		<meta itemprop="description" content="Simulación Tsunami - Data asset Talcahuano,Chile">
		<meta name="twitter:card" content="summary_large_image"/>
		<meta name="twitter:image" content="./"/>

		<meta name="twitter:title" content="Simulación Tsunami"/>
		<meta name="twitter:description" content="Simulación Tsunami - Data asset Talcahuano,Chile"/>

		<meta property="og:title" content="Simulación Tsunami" />
		<meta property="og:description" content="Simulación Tsunami - Data asset Talcahuano,Chile" />
		<meta property="og:type" content="website" />
		<meta property="og:url" content="./" />
		<meta property="og:image" content="./"/>
		<meta property="og:updated_time" content="2014-04-09T00:00:00+00:00" />

		<link rel="alternate" type="application/rss+xml" href="./index.xml" title="Simulación Tsunami" />

		<style>
			#video {
				position: fixed;
				display: block;
				height: 120px;
			}	

			.container {
				z-index: 2;
			}

			body {
				background-color: orangered;
			}

			.texto {
				font-size: 1.5rem;
			}			

			svg {
			width: 100px;
			height: 100px;
			cursor: pointer;
			z-index: 51;
			}

			canvas{
				position: fixed;
				z-index: 0;
				left: 0px;
				top: 0px;
				outline: none; 
				border: none; 
				overflow: hidden;
			}

			*:focus{ 
				outline: none; 
				border: none; 
			}

			.controles {
				z-index: 10;
    			position: absolute;
				top: 10px;
				left: 50%;
				transform: translateX(-50%);
			}

			.controles svg {
				width: 50px;
    			height: 50px;
				display: none;
			}

			.helper {
				position: absolute;
				left: 10%;
				top: 10%;
				display: none;				
			}

			.helper h6{
				line-height: 0;
			}
		</style>

	</head>

	<body class="dark-theme">
		<div class="helper">
			<h4>Controles</h4>
			<h6>ROTAR: Click Izquierdo</h6>
			<h6>MOVER: Click Derecho</h6>
			<h6>ZOOM: Rueda Mouse</h6>
		</div>

		<div class="controles">
			<svg id="startButton" class="controles-start" viewbox="0 0 140 140">
				<circle cx="70" cy="70" r="65" style="fill:#fff;stroke:#ddd"/>
				<polygon id="shape" points="50,40 100,70 100,70 50,100, 50,40" style="fill:#aaa;">
					<animate 
					id="animate_to_stop" 
					begin="indefinite" 
					fill="freeze" 
					attributeName="points" 
					dur="500ms" 
					to="45,45 95,45 95,95, 45,95 45,45"
					keySplines="
						0.1 0.8 0.2 1; 
						0.1 0.8 0.2 1; 
						0.1 0.8 0.2 1; 
						0.1 0.8 0.2 1; 
						0.1 0.8 0.2 1; 
						0.1 0.8 0.2 1"
					keyTimes="0;0.22;0.33;0.55;0.66;0.88;1" 
					calcMode="spline"
					/>
					
					<animate 
					id="animate_to_play" 
					begin="indefinite" 
					fill="freeze" 
					attributeName="points" 
					dur="500ms" 
					to="50,40 100,70 100,70 50,100, 50,40" 
					keySplines="
						0.1 0.8 0.2 1; 
						0.1 0.8 0.2 1; 
						0.1 0.8 0.2 1; 
						0.1 0.8 0.2 1; 
						0.1 0.8 0.2 1; 
						0.1 0.8 0.2 1"
					keyTimes="0;0.22;0.33;0.55;0.66;0.88;1" 
					calcMode="spline"
					/>
				</polygon>
				</svg>

		</div>
		
		<div class="container">
            <header class="header">
    <span class="header__inner">
        <a href="./" style="text-decoration: none;">
    <div class="logo">
        
            <span class="logo__text">Simulación Tsunami</span>
        
    </div>
</a>    


        <span class="header__right">
            
                <nav class="menu">
    
</nav>
        </span>
    </span>
</header>
	

            <div class="content">
                
    <main aria-role="main">
        <div>
			<h1 class="titulo-simulacion">Simulación Tsunami</h1>
			
				<p class="subtitulo-simulacion">Data asset: Talcahuano, Chile.</p>
				<div id="canvas" style="display: none;"></div>
				
				<h1  class="texto">Click para Iniciar</h1>

				<svg id="startButton" viewbox="0 0 140 140">
				<circle cx="70" cy="70" r="65" style="fill:#fff;stroke:#ddd"/>
				<polygon id="shape" points="50,40 100,70 100,70 50,100, 50,40" style="fill:#aaa;">
					<animate 
					id="animate_to_stop" 
					begin="indefinite" 
					fill="freeze" 
					attributeName="points" 
					dur="500ms" 
					to="45,45 95,45 95,95, 45,95 45,45"
					keySplines="
						0.1 0.8 0.2 1; 
						0.1 0.8 0.2 1; 
						0.1 0.8 0.2 1; 
						0.1 0.8 0.2 1; 
						0.1 0.8 0.2 1; 
						0.1 0.8 0.2 1"
					keyTimes="0;0.22;0.33;0.55;0.66;0.88;1" 
					calcMode="spline"
					/>
					
					<animate 
					id="animate_to_play" 
					begin="indefinite" 
					fill="freeze" 
					attributeName="points" 
					dur="500ms" 
					to="50,40 100,70 100,70 50,100, 50,40" 
					keySplines="
						0.1 0.8 0.2 1; 
						0.1 0.8 0.2 1; 
						0.1 0.8 0.2 1; 
						0.1 0.8 0.2 1; 
						0.1 0.8 0.2 1; 
						0.1 0.8 0.2 1"
					keyTimes="0;0.22;0.33;0.55;0.66;0.88;1" 
					calcMode="spline"
					/>
				</polygon>
				</svg>
		</div>

    </main>

            </div>

            
                <footer class="footer">
    <div class="footer__inner">
        <div class="footer__content">
            <span>&copy; 2020</span>
            
                <span><a href="https://github.com/josemagr95/">José Gómez</a></span>
            
            
                <span><a href="https://creativecommons.org/licenses/by-nc/4.0/" target="_blank" rel="noopener">CC BY-NC 4.0</a></span>
            
            
        </div>
    </div>
    <div class="footer__inner">
        <div class="footer__content">
            <span>Powered by <a href="http://gohugo.io">Hugo</a></span>
            <span>Prototipo desarrollado con Three.JS y VideoTexture</span>
        </div>
    </div>
</footer>

            
		</div>
		


		<video id="video" loop muted crossOrigin="anonymous" playsinline style="display:none">
			<source src="textures/tsunami-rotated-mirror-crop.mp4" type='video/mp4; codecs="avc1.42E01E, mp4a.40.2"'>
		</video>

		<video id="audio" loop crossOrigin="anonymous" playsinline style="display:none">
			<source src="textures/audio-tsunami.mp4" type='video/mp4; codecs="avc1.42E01E, mp4a.40.2"'>
		</video>

		<script type="text/javascript" src="./bundle.min.dc716e9092c9820b77f96da294d0120aeeb189b5bcea9752309ebea27fd53bbe6b13cffb2aca8ecf32525647ceb7001f76091de4199ac5a3caa432c070247f5b.js" integrity="sha512-3HFukJLJggt3&#43;W2ilNASCu6xibW86pdSMJ6&#43;on/VO75rE8/7KsqOzzJSVkfOtwAfdgkd5BmaxaPKpDLAcCR/Ww=="></script>
		<script type="text/javascript" src="./js/jquery.min.js"></script>
		<script type="text/javascript" src="./js/script.js"></script>
		<script type="module">

			import * as THREE from './build/three.module.js';

			import { OrbitControls } from './jsm/controls/OrbitControls.js';
			import { GLTFLoader } from './jsm/loaders/GLTFLoader.js';
			import { DRACOLoader } from './jsm/loaders/DRACOLoader.js';
			import { RGBELoader } from './jsm/loaders/RGBELoader.js';
			import { RoughnessMipmapper } from './jsm/utils/RoughnessMipmapper.js';

			var canvas, stats, controls;
			var video, audio, videotexture, material;
			var camera, scene, renderer;

			window.onload = function() {

				init();
				animate();
			};


			function init() {

				canvas = document.createElement( 'div' );
				var elem = document.getElementById('canvas');
				elem.appendChild( canvas );

				camera = new THREE.PerspectiveCamera( 45, window.innerWidth / window.innerHeight, 0.25, 20 );
				camera.position.set( 7, 4, 7 );

				scene = new THREE.Scene();

				video = document.getElementById( 'video' );
				video.play();
				video.pause();

				videotexture = new THREE.VideoTexture( video );

				videotexture.format = THREE.RGBFormat;
				videotexture.encoding = THREE.sRGBEncoding;
				videotexture.wrapS = videotexture.wrapT = THREE.ClampToEdgeWrapping;
				videotexture.magFilter = THREE.LinearFilter;
				videotexture.mapping = THREE.EquirectangularReflectionMapping;

        		var materialVideo = new THREE.MeshBasicMaterial( { map: videotexture } )


				new RGBELoader()
					.setDataType( THREE.UnsignedByteType )
					.setPath( 'textures/equirectangular/' )
					.load( 'spot1Lux.hdr', function ( texture ) {

						var envMap = pmremGenerator.fromEquirectangular( texture ).texture;
						pmremGenerator.dispose();
						
						scene.environment = envMap;

						// model

						var roughnessMipmapper = new RoughnessMipmapper( renderer );

						// Instantiate a loader
						var loader = new GLTFLoader();

						// Optional: Provide a DRACOLoader instance to decode compressed mesh data
						var dracoLoader = new DRACOLoader();
						dracoLoader.setDecoderPath( './js/libs/draco/' );
						loader.setDRACOLoader( dracoLoader );

						// Load a glTF resource
						loader.load(
							// resource URL
							'models/gltf/Tsunami/tsunami_v7.gltf',
							// called when the resource is loaded
							function ( gltf ) {

								gltf.scene.children[0].material = materialVideo;

								scene.add( gltf.scene );

								var mesh = gltf.scene;

								gltf.animations; // Array<THREE.AnimationClip>
								gltf.scene; // THREE.Group
								gltf.scenes; // Array<THREE.Group>
								gltf.cameras; // Array<THREE.Camera>
								gltf.asset; // Object

							},
							// called while loading is progressing
							function ( xhr ) {

								console.log( ( xhr.loaded / xhr.total * 100 ) + '% loaded' );

							},
							// called when loading has errors
							function ( error ) {

								console.log( 'An error happened' );

							}
						);


					} );

				renderer = new THREE.WebGLRenderer( { antialias: true , alpha: true} );
				renderer.setPixelRatio( window.devicePixelRatio );
				renderer.setSize( window.innerWidth, window.innerHeight );
				renderer.toneMapping = THREE.ACESFilmicToneMapping;
				renderer.outputEncoding = THREE.sRGBEncoding;
				canvas.appendChild( renderer.domElement );

				var pmremGenerator = new THREE.PMREMGenerator( renderer );
				pmremGenerator.compileEquirectangularShader();

				controls = new OrbitControls( camera, renderer.domElement );
				controls.target.set( 0, 0, - 0.2 );
				controls.enableDamping = false;
				controls.dampingFactor = 0.1;
				controls.rotateSpeed = 0.1;
				controls.zoomSpeed = 0.5;
				controls.panSpeed = 0.1;
				controls.update();

				window.addEventListener( 'resize', onWindowResize, false );


			}

			function onWindowResize() {

				camera.aspect = window.innerWidth / window.innerHeight;
				camera.updateProjectionMatrix();

				renderer.setSize( window.innerWidth, window.innerHeight );

			}

			//

			function animate() {

				requestAnimationFrame( animate );

				renderer.render( scene, camera );

			}


		</script>

	</body>
</html>
